{
  "export_version": 1,
  "payload_information": {
    "payload_type": "Command",
    "payload_name": "Create local account",
    "payload_description": "An adversary may wish to create an account with admin privileges to work with. In this test we create a \"art\" user with the password art, switch to art, execute whoami, exit and delete the art user.\n",
    "payload_platforms": [
      "Linux"
    ],
    "payload_attack_patterns": [
      {
        "attack_pattern_id": "70651959-5a3e-4a7d-aaa5-89b7312a21b1",
        "attack_pattern_name": "Local Accounts",
        "attack_pattern_description": "Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service.\n\nLocal Accounts may also be abused to elevate privileges and harvest credentials through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement. ",
        "attack_pattern_external_id": "T1078.003",
        "attack_pattern_kill_chain_phases": null
      }
    ],
    "payload_cleanup_executor": "bash",
    "payload_cleanup_command": "[ \"$(uname)\" = 'Linux' ] && userdel art -rf || rmuser -y art\n",
    "payload_elevation_required": true,
    "payload_arguments": [],
    "payload_prerequisites": [],
    "payload_external_id": "84ad1dfe-0b96-452c-a122-4767aab6584e",
    "payload_source": "FILIGRAN",
    "payload_expectations": [
      "PREVENTION",
      "DETECTION"
    ],
    "payload_status": "VERIFIED",
    "payload_execution_arch": "ALL_ARCHITECTURES",
    "payload_detection_remediations": [],
    "payload_tags": [],
    "payload_output_parsers": [],
    "payload_created_at": "2025-06-20T09:48:04.165921Z",
    "payload_updated_at": "2025-07-28T04:00:51.234396Z",
    "command_executor": "bash",
    "command_content": "password=$(openssl passwd -1 art)\n([ \"$(uname)\" = 'Linux' ] && useradd --shell /bin/bash --create-home --password $password art) || (pw useradd art -g wheel -s /bin/sh && (echo $password | pw mod user testuser1 -h 0))\nsu art -c \"whoami; exit\"\n"
  },
  "payload_tags": [],
  "payload_attack_patterns": [
    {
      "attack_pattern_id": "70651959-5a3e-4a7d-aaa5-89b7312a21b1",
      "attack_pattern_name": "Local Accounts",
      "attack_pattern_description": "Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service.\n\nLocal Accounts may also be abused to elevate privileges and harvest credentials through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement. ",
      "attack_pattern_external_id": "T1078.003",
      "attack_pattern_kill_chain_phases": null
    }
  ],
  "payload_arguments_documents": []
}